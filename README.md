# Docker-compose

## Стек php + apache + mariaDB + phpMyAdmin

Данный репозиторий представляет собой небольшой тест Docker для компании Каскад-Технологии.

Основной целью применения Docker является быстрое развертывание окружения на локальных компьютерах. Также
данное ПО обеспечивает легкую переносимость приложений благодаря применению контейнезированного подхода.

Применение Docker в нынешнее время обосновано тем, что раньше программист писал код и документацию к нему в которой
описывалось какие необходимые пакеты должен установить системный администратор на сервере, чтобы данное приложение
запустилось на production. Такой подход не удобен тем, что пакеты необходимые для работы приложения постоянно добавляются,
тем самым документация усложняется и тем самым увеличивается шанс упустить какой-либо пакет. Таким образом, 
если программист забудет указать какой либо пакет в документации и передаст ее системному администратору,
то его код на production работать не будет.

Сейчас Docker позволяет программисту самостоятельно описывать среду в которой должно работать приложение, то есть
он создает свой образ окружения(image) с помощью Dockerfile. Далее данный файл передается системному администратору,
системный администратор запускает контейнер этого образа на сервере и приложение работает точно также как и работало
на локальном компьютере программиста.

#### Пример Dockerfile

`FROM node:18-alpine WORKDIR /app COPY . . RUN yarn install --production CMD ["node", "src/index.js"]
EXPOSE 3000`

#### Пример docker-compose файла
````
    version '2'
    volumes:
        nextcloud:
        db:

    services:
        db:
            image: mariadb:10.6
            restart: always
            volumes:
                - db:/var/lib/mysql
            environment:
                - MYSQL_ROOT_PASSWORD=
                - MYSQL_PASSWORD=
                - MYSQL_DATABASE=nextcloud
                - MYSQL_USER=nextcloud

        app:
            image: nextcloud
            restart: always
            ports:
                - 8080:80
            links:
                - db
            volumes:
                - nextcloud:/var/www/html
            environment:
                - MYSQL_PASSWORD=
                - MYSQL_DATABASE=nextcloud
                - MYSQL_USER=nextcloud
                - MYSQL_HOST=db
````

Чтобы запустить данный проект у вас должен быть скачан docker и docker-compose.

Затем командой ``docker compose up `` вы можете запустить контейнеры apache, php, mariaDB, phpMyAdmin.

Для остановки всех контейнеров воспользуйтесь командой ``docker compose stop``. В этом случае контейнеры 
будут остановлены, но не удалены для удаления контейнеров можно воспльзоваться следующими командами:

1. ``docker rm <containerID or containerName:tag>`` - в данном случае мы можем удалить один или более контейнеров, но что если контейнеров много?
2. ``docker container prune -f`` - команда удаляет все остановленные контейнеры (ключ -f указывает на то что удаления произойдет без подтверждения)

Для того чтобы убедиться какие контейнеры сейчас работают используйте ``docker ps``, а если хотите посмотреть
все контейнеры, которые на данный момент существуют воспользуйтесь этой же комнадой добавив ключ **-a**

